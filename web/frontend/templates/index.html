<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ LotoScope Web - Gerador Interativo</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1><i class="fas fa-bullseye"></i> LotoScope Web</h1>
            <p>Gerador Interativo de Combina√ß√µes da Lotof√°cil</p>
        </header>

        <!-- Main Layout: Duas Colunas -->
        <div class="main-layout">
            <!-- Coluna Esquerda: Informa√ß√µes e Configura√ß√µes -->
            <div class="sidebar">
                <!-- Informa√ß√µes do Concurso -->
                <section class="contest-info-card">
                    <h3><i class="fas fa-bullseye"></i> Previs√£o para o Concurso</h3>
                    <div id="contestInfo" class="contest-grid">
                        <div class="contest-item">
                            <span class="contest-label">Pr√≥ximo concurso:</span>
                            <span id="nextContest" class="contest-value">Carregando...</span>
                        </div>
                        <div class="contest-item">
                            <span class="contest-label">Baseado no concurso:</span>
                            <span id="lastContest" class="contest-value">Carregando...</span>
                        </div>
                        <div class="contest-item">
                            <span class="contest-label">Tend√™ncia atual:</span>
                            <span id="currentTrend" class="contest-value">Carregando...</span>
                        </div>
                        <div class="contest-item current-numbers">
                            <span class="contest-label">N√∫meros do sorteio atual:</span>
                            <div id="currentNumbers" class="contest-value numbers-display">Carregando...</div>
                        </div>
                    </div>
                </section>

                <!-- Configura√ß√µes -->
                <section class="config-card">
                    <h3><i class="fas fa-cog"></i> Configura√ß√µes</h3>
                    
                    <div class="form-group">
                        <label for="gameSize">N√∫meros por jogo:</label>
                        <select id="gameSize" class="form-control">
                            <option value="15" selected>15 n√∫meros</option>
                            <option value="16">16 n√∫meros</option>
                            <option value="17">17 n√∫meros</option>
                            <option value="18">18 n√∫meros</option>
                            <option value="19">19 n√∫meros</option>
                            <option value="20">20 n√∫meros</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="quantity">Combina√ß√µes a gerar:</label>
                        <input type="number" id="quantity" class="form-control" value="1" min="0" max="10000" placeholder="Deixe vazio para TODAS">
                        <small class="form-text">
                            <i class="fas fa-info-circle"></i> Deixe vazio ou 0 para gerar TODAS as combina√ß√µes
                        </small>
                    </div>

                    <div class="form-group">
                        <label>N√∫meros fixos selecionados:</label>
                        <div id="fixedCount" class="info-display">0 n√∫meros</div>
                        <div id="fixedNumbers" class="fixed-numbers-display"></div>
                    </div>

                    <!-- üö´ Se√ß√£o de N√∫meros Exclu√≠dos -->
                    <div class="form-group">
                        <label>üö´ N√∫meros exclu√≠dos:</label>
                        <div id="excludedCount" class="info-display">0 n√∫meros</div>
                        <div id="excludedNumbers" class="fixed-numbers-display"></div>
                        <small class="form-text">
                            <i class="fas fa-ban"></i> N√∫meros que <strong>N√ÉO</strong> aparecer√£o em nenhuma combina√ß√£o
                        </small>
                    </div>

                    <!-- Probabilidade -->
                    <div class="probability-card">
                        <h4><i class="fas fa-chart-line"></i> Probabilidade</h4>
                        <div id="probabilityDisplay" class="probability-grid">
                            <div class="prob-item">
                                <span class="prob-label">Total de combina√ß√µes:</span>
                                <span id="totalCombinations" class="prob-value">-</span>
                            </div>
                            <div class="prob-item">
                                <span class="prob-label">Chance de acerto:</span>
                                <span id="probability" class="prob-value">-</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Perfil de Risco -->
                <section class="config-card">
                    <h3><i class="fas fa-target"></i> Perfil de Risco</h3>
                    <div class="form-group">
                        <label for="riskProfile">Estrat√©gia de Filtros:</label>
                        <select id="riskProfile" class="form-control">
                            <option value="moderado" selected>üìä Moderado - Usar previs√µes exatas</option>
                            <option value="conservador">üõ°Ô∏è Conservador - Ampliar faixas (+seguran√ßa)</option>
                            <option value="agressivo">üéØ Agressivo - Focar na m√©dia (menos op√ß√µes)</option>
                            <option value="sem_perfil">üîì Sem Perfil - Todas as combina√ß√µes poss√≠veis</option>
                        </select>
                        <small class="form-text">Define como aplicar os resultados da an√°lise sequencial nos filtros. "Sem Perfil" retorna todas as combina√ß√µes sem filtros din√¢micos</small>
                    </div>
                </section>

                <!-- Menu de An√°lises Avan√ßadas -->
                <section class="config-card">
                    <h3><i class="fas fa-chart-bar"></i> An√°lises Avan√ßadas</h3>
                    
                    <div class="advanced-menu">
                        <div class="menu-item">
                            <span class="menu-number">6.</span>
                            <button id="analiseSequencialBtn" class="btn btn-info btn-analysis">
                                <i class="fas fa-search"></i> An√°lise Sequencial
                            </button>
                            <small class="menu-description">Padr√µes hist√≥ricos de menor_que, maior_que e igual_ao_ultimo</small>
                        </div>
                        
                        <div class="menu-item">
                            <span class="menu-number">7.</span>
                            <button id="refreshCacheBtn" class="btn btn-warning btn-analysis">
                                <i class="fas fa-sync-alt"></i> Atualizar An√°lise
                            </button>
                            <small class="menu-description">Limpar cache e buscar dados mais recentes</small>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Coluna Direita: Seletor de N√∫meros -->
            <div class="main-area">
                <section class="numbers-selector">
                    <h3><i class="fas fa-th"></i> Selecione os N√∫meros Fixos (0-25)</h3>
                    <div id="numbersGrid" class="numbers-grid">
                        <!-- Numbers 1-25 will be generated by JavaScript -->
                    </div>
                    <div class="grid-info">
                        <div style="text-align: center; margin-top: 10px; line-height: 1.5;">
                            <p><strong><i class="fas fa-mouse-pointer"></i> Instru√ß√µes de Clique (4 Estados):</strong></p>
                            <p><span style="color: var(--selected-color);"><strong>1¬∫ clique:</strong></span> Selecionar (azul - estrat√©gia percentual)</p>
                            <p><span style="color: #f39c12;"><strong>2¬∫ clique:</strong></span> Obrigat√≥rio (dourado + ‚òÖ - todas as combina√ß√µes)</p>
                            <p><span style="color: var(--excluded-color);"><strong>3¬∫ clique:</strong></span> Excluir (cinza + √ó)</p>
                            <p><span style="color: #666;"><strong>4¬∫ clique:</strong></span> Voltar ao normal</p>
                            
                            <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                <p><strong><i class="fas fa-brain"></i> Estrat√©gias Avan√ßadas:</strong></p>
                                <p><strong>ÔøΩ Selecionados:</strong> Usam estrat√©gia percentual inteligente</p>
                                <p><strong>üü° Obrigat√≥rios:</strong> Aparecem em TODAS as combina√ß√µes</p>
                                <p><strong>üî¥ Exclu√≠dos:</strong> N√ÉO aparecem em nenhuma combina√ß√£o</p>
                                <p><em>Combine at√© 25 n√∫meros entre selecionados e obrigat√≥rios!</em></p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- A√ß√µes -->
                <div class="actions-bar">
                    <button id="clearSelection" class="btn btn-secondary">
                        <i class="fas fa-eraser"></i> Limpar Sele√ß√£o
                    </button>
                    <button id="generateBtn" class="btn btn-primary">
                        <i class="fas fa-magic"></i> Gerar Combina√ß√µes
                    </button>
                </div>
            </div>
        </div>

        <!-- Resultados (Full Width) -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <div class="results-header">
                <h3><i class="fas fa-list"></i> Combina√ß√µes Geradas</h3>
                <div class="results-actions">
                    <button id="exportBtn" class="btn btn-success" style="display: none;">
                        <i class="fas fa-download"></i> Exportar TXT
                    </button>
                </div>
            </div>
            <div id="loadingSpinner" class="loading" style="display: none;">
                <i class="fas fa-spinner fa-spin"></i> Gerando combina√ß√µes...
            </div>
            <div id="resultsContainer" class="results-container">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>

        <!-- Status Bar -->
        <div id="statusBar" class="status-bar">
            <span id="statusMessage">Sistema pronto</span>
        </div>

        <!-- Modal de Explica√ß√£o dos Filtros -->
        <div id="filtersModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-info-circle"></i> Como funcionam os filtros</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <h4>üéØ Filtros de Tend√™ncia Din√¢mica</h4>
                    <p>O sistema analisa os √∫ltimos 200 concursos e aplica filtros inteligentes baseados nas tend√™ncias identificadas:</p>

                    <div class="filter-explanation">
                        <h5>üìä Filtros Estat√≠sticos Fixos</h5>
                        <ul>
                            <li><strong>Pares/√çmpares:</strong> Entre 6-10 n√∫meros pares</li>
                            <li><strong>Primos:</strong> Entre 4-8 n√∫meros primos</li>
                            <li><strong>Sequ√™ncias:</strong> M√°ximo 3 n√∫meros consecutivos</li>
                            <li><strong>Repeti√ß√µes:</strong> Entre 8-12 n√∫meros do √∫ltimo sorteio</li>
                        </ul>
                        <em>WHERE NumerosPares BETWEEN 6 AND 10 AND NumerosPrimos BETWEEN 4 AND 8</em>
                    </div>

                    <div class="filter-explanation">
                        <h5>üîÆ Filtros Din√¢micos de Tend√™ncia</h5>
                        <ul>
                            <li><strong>Soma Total:</strong> Ajustada conforme tend√™ncia (ESTABILIDADE, CRESCIMENTO, QUEDA)</li>
                            <li><strong>Compara√ß√£o com √öltimo:</strong> N√∫meros maiores/menores que o √∫ltimo sorteio</li>
                            <li><strong>Ranges Posicionais:</strong> N√∫meros baixos (1-9), m√©dios (10-17), altos (18-25)</li>
                        </ul>
                        <em>SomaTotal BETWEEN [valor_dinamico] AND [valor_dinamico]</em>
                    </div>

                    <div class="filter-explanation">
                        <h5>‚ö° Integra√ß√£o com An√°lise Preditiva</h5>
                        <p>Os filtros s√£o atualizados a cada hora com base no m√≥dulo <code>relatorio_tendencias_preditivas.py</code> que:</p>
                        <ul>
                            <li>Analisa padr√µes dos √∫ltimos 200 concursos</li>
                            <li>Identifica tend√™ncias de soma e distribui√ß√£o</li>
                            <li>Ajusta dinamicamente os ranges de filtros</li>
                            <li>Aplica estrat√©gias conservadoras, agressivas ou sem filtros (sem_perfil)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bot√£o de Informa√ß√µes -->
        <button id="infoBtn" class="info-btn" title="Como funcionam os filtros">
            <i class="fas fa-question"></i>
        </button>
    </div>

    <!-- Modal An√°lise Sequencial -->
    <div id="analiseSequencialModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-search"></i> An√°lise Sequencial de Padr√µes
                </h2>
                <span class="close" id="closeAnaliseModal">&times;</span>
            </div>
            <div id="analiseSequencialContent">
                <div class="analysis-loading">
                    <div class="loading-spinner"></div>
                    <p>Carregando an√°lise sequencial...</p>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>